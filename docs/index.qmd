---
title: "A Reproducible Example Using the Spaceflights Tutorial"
author: "Rob Wiederstein"
date: today
---


```{python}
#| label: setup
#| include: false

# Standard library imports
import os
import sys
from pathlib import Path
import logging
import datetime

# Third-party library imports
import pandas as pd
from IPython.display import display, Image, Markdown

# function
from pathlib import Path
from IPython.display import Image, display

def pull_latest_version_plot(
    name: str,
    base_dir: str,
):
    """
    Locate the most recent timestamped subfolder under `{base_dir}/{name}.png`,
    then display the image `{name}.png` inside it.

    Parameters:
    - name:     The base name of the versioned‚Äêplot folder (e.g., "dummy_confusion_matrix")
    - base_dir: Path to the parent reporting directory (default: "../data/08_reporting")
    """
    # 1) Build the path to the versioned directory for this plot
    versioned_dir = Path(base_dir) / name

    # 2) List all subfolders (each is a timestamp)
    all_versions = [p for p in versioned_dir.iterdir() if p.is_dir()]
    if not all_versions:
        raise FileNotFoundError(f"No versioned images found in {versioned_dir!r}")

    # 3) Pick the lexicographically largest (i.e., most recent) folder
    latest_dir = sorted(all_versions)[-1]

    # 4) Construct the full path to the image file
    img_path = latest_dir / f"{name}.png"

    # 5) Display it
    display(Image(filename=str(img_path)))

```


# Introduction

This project ports the spaceflights tutorial from [Kedro](https://kedro.org/).  Its significance is that it builds a reproducible pipeline within a broadly accepted python framework.[@wilson_best_2014]  The Kedro framework envisions the use of Sphinx, the widely used Python documentation system.  However, the Sphinx default was changed to Quarto. 


```{python}
#| label: fig-test-static
#| fig-cap: "A moon rocket."

from IPython.display import Image
Image(filename="resources/moon-rocket.jpg") 
```


# Datasets

## Companies

```{python}
#| label: tbl-companies-head
#| tbl-cap: "First 5 rows of the Companies dataset."
df = pd.read_csv("../data/01_raw/companies.csv")
df.head(5)
```

## Reviews 

```{python}
#| label: tbl-reviews-head
#| tbl-cap: "First 5 rows of the Reviews dataset."
df = pd.read_csv("../data/01_raw/reviews.csv")
df.head(5)
```

## Shuttles

```{python}
#| label: tbl-shuttles-head
#| tbl-cap: "First 5 rows of the Shuttles dataset."
df = pd.read_excel("../data/01_raw/shuttles.xlsx")
df.head(5)
```

# Model Inputs

```{python}
#| label: tbl-model-input-head
#| tbl-cap: "First 5 rows of the Model Input Table"
df = pd.read_parquet("../data/03_primary/model_input_table.parquet")
df.head(5)
```


# Results 
```{python}
#| label: fig-confusion-matrix
#| fig-cap: "Results."
#| eval: FALSE
img_path = "../data/08_reporting/dummy_confusion_matrix.png/2025-05-22T12.16.33.752Z/dummy_confusion_matrix.png"
display(Image(filename=img_path))
```

```{python}
pull_latest_version_plot(name="dummy_confusion_matrix", base_dir="../data/08_reporting")
```


For more information, see moon rocket at [@fig-test-static].


# References {.unnumbered}

:::{#refs}
:::
