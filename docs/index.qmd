---
title: "A Reproducible Example Using the Spaceflights Tutorial"
author: "Rob Wiederstein"
date: today
---


```{python}
#| label: setup
#| include: false

# Standard library imports
import os
import sys
from pathlib import Path
import logging
import datetime

# Third-party library imports
import pandas as pd
from IPython.display import display, Image, Markdown
from great_tables import GT
```


# Introduction

This project ports the spaceflights tutorial from [Kedro](https://kedro.org/).  Its significance is that it builds a reproducible pipeline within a broadly accepted python framework.[@wilson_best_2014]  The Kedro framework envisions the use of Sphinx, the widely used Python documentation system.  However, the Sphinx default was changed to Quarto. 


```{python}
#| label: fig-test-static
#| fig-cap: "A moon rocket."

from IPython.display import Image
Image(filename="resources/moon-rocket.jpg") 
```


# Datasets

## Companies

```{python}
#| label: tbl-companies-head
#| tbl-cap: "First 5 rows of the Companies dataset."
df = pd.read_csv("../data/01_raw/companies.csv")
df.head(5)
```

## Reviews 

```{python}
#| label: tbl-reviews-head
#| tbl-cap: "First 5 rows of the Reviews dataset."
df = pd.read_csv("../data/01_raw/reviews.csv")
df.head(5)
```

## Shuttles

```{python}
#| label: tbl-shuttles-head
#| tbl-cap: "First 5 rows of the Shuttles dataset."
df = pd.read_excel("../data/01_raw/shuttles.xlsx")
df.head(5)
```

# Model Inputs

```{python}
#| label: tbl-model-input-head
#| tbl-cap: "First 5 rows of the Model Input Table"
df = pd.read_parquet("../data/03_primary/model_input_table.parquet")
df.head(5)
```


# Results 
```{python}
#| label: fig-confusion-matrix
#| fig-cap: "Results."
#| eval: FALSE
img_path = "../data/08_reporting/dummy_confusion_matrix.png/2025-05-22T12.16.33.752Z/dummy_confusion_matrix.png"
display(Image(filename=img_path))
```

```{python}
def pull_latest_version_plot(
    base_folder: str = "../data/08_reporting/dummy_confusion_matrix.png",
    filename: str = "dummy_confusion_matrix.png"
):
    """
    Locate the most recent timestamped subfolder under `base_folder`, then display
    the image named `filename` inside it.

    Parameters:
    - base_folder: Path to the versioned‐plot directory (default: "../data/08_reporting/dummy_confusion_matrix.png")
    - filename:     Name of the image file inside each timestamped folder
    """
    base_dir = Path(base_folder)

    # 1) List all versioned timestamp directories
    all_versions = [p for p in base_dir.iterdir() if p.is_dir()]
    if not all_versions:
        raise FileNotFoundError(f"No versioned images found in {base_dir!r}")

    # 2) Pick the alphabetically “largest” folder name → the most recent timestamp
    latest_dir = sorted(all_versions)[-1]

    # 3) Build the full path to the image file
    img_path = latest_dir / filename

    # 4) Display it in the current Jupyter/Quarto context
    display(Image(filename=str(img_path)))

pull_latest_version_plot()
```


For more information, see moon rocket at [@fig-test-static].


# References {.unnumbered}

:::{#refs}
:::
